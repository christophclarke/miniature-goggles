{% extends 'malsearch/dash_base.html' %}

{% block main %}
    <div class="row mt-3">
        <div class="col">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">Sample Info</h1>
                <div class="btn-toolbar mb-2 mb-md-0">
                    <div class="btn-group mr-2">
                        <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
                        <a href="{% url 'sample_detail_export' sample.sample_id %}" target="_blank" rel="noopener noreferrer"
                           class="btn btn-sm btn-outline-secondary">Export</a>
                    </div>
                </div>
            </div>
            <dl>
                <dt>Filename</dt>
                <dd>{{ sample.file_name }}</dd>
                <dt>File Path</dt>
                <dd>{{ sample.file_path }}</dd>
                <dt>File Size</dt>
                <dd>{{ sample.file_size }} bytes</dd>

                <dt>MD5 Hash</dt>
                <dd>{{ sample.hash_md5 }}</dd>
                <dt>SHA1 Hash</dt>
                <dd>{{ sample.hash_sha1 }}</dd>
                <dt>SHA256 Hash</dt>
                <dd>{{ sample.hash_sha256 }}</dd>

                <dt>Date Added</dt>
                <dd>{{ sample.date_added }}</dd>

                <dt>Last Scanned</dt>
                <dd>{{ sample.last_scanned }}</dd>
            </dl>

            <h3 class="mt-5">Scan History</h3>
            {% for scan in scans %}
                <hr>
                <dl>
                    <dt>Date Scanned</dt>
                    <dd>{{ scan.date_time_scanned }}</dd>

                    <dt>File Type</dt>
                    <dd>{{ scan.file_type }}</dd>
                    <dt>Platform</dt>
                    <dd>{{ scan.platform }}</dd>
                </dl>
            {% endfor %}
        </div>
        <div class="col">
            <form method="post" action="{% url 'sample_detail_comment_update' sample.sample_id %}">
                {% csrf_token %}
                <div class="form-group">
                    <input type="hidden" id="id_user_id" name="user_id" value="{{ request.user.id }}">
                </div>
                <div class="form-group">
                    <label for="id_comment">Comment: </label>
                    <textarea class="form-control" id="id_comment">{{ comment }}</textarea>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>
    </div>
{% endblock %}